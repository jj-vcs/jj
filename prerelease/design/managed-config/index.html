
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.jj-vcs.dev/latest/design/managed-config/">
      
      
        <link rel="prev" href="../secure-config/">
      
      
        <link rel="next" href="../jj-converge-command/">
      
      
      <link rel="icon" href="../../images/favicon-96x96.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>Managed config - Jujutsu docs (prerelease)</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CGoogle+Sans+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Google Sans Code"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#repo-managed-jj-configuration" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Jujutsu docs (prerelease)" class="md-header__button md-logo" aria-label="Jujutsu docs (prerelease)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Jujutsu docs (prerelease)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Managed config
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/jj-vcs/jj" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    jj-vcs/jj
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Jujutsu docs (prerelease)" class="md-nav__button md-logo" aria-label="Jujutsu docs (prerelease)" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Jujutsu docs (prerelease)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jj-vcs/jj" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    jj-vcs/jj
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install-and-setup/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation and setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial and bird's eye view
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../gerrit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working with Gerrit
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../github/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working with GitHub
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../windows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working on Windows
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../FAQ/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cli-reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLI reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../testimonials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testimonials
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../community_tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Community-built tools
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Concepts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../working-copy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Working copy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bookmarks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Bookmarks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../conflicts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conflicts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../operation-log/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Operation log
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../glossary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Guides
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Guides
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/cli-revision-options/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLI options for specifying revisions
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/divergence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Divergent changes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guides/multiple-remotes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multiple remotes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../filesets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fileset language
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../revsets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Revset language
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../templates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Templating language
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Comparisons
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Comparisons
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git-comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git comparison
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git-command-table/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git command table
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git-compatibility/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git compatibility
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git-experts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Jujutsu for Git experts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sapling-comparison/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sapling comparison
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../related-work/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Other related work
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Technical details
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Technical details
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../core_tenets/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core tenets
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technical/architecture/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technical/concurrency/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concurrency
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../technical/conflicts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conflicts
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          <label class="md-nav__link" for="__nav_12" id="__nav_12_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Contributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guidelines and "How to...?"
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../code-of-conduct/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of conduct
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../style_guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Style guide
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design_docs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Design docs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../design_doc_blueprint/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Design doc blueprint
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../releasing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Releasing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../governance/temporary-voting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Temporary voting for governance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../governance/GOVERNANCE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Governance
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" checked>
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Design docs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Design docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../git-submodules/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    git-submodules
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../git-submodule-storage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    git-submodule-storage
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../run/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JJ run
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sparse-v2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sparse patterns v2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tracking-branches/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tracking branches
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../copy-tracking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Copy tracking and tracing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../secure-config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Secure config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Managed config
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Managed config
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    <span class="md-ellipsis">
      Objective
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detailed-design" class="md-nav__link">
    <span class="md-ellipsis">
      Detailed Design
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Detailed Design">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security" class="md-nav__link">
    <span class="md-ellipsis">
      Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trust-levels" class="md-nav__link">
    <span class="md-ellipsis">
      Trust levels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-interface" class="md-nav__link">
    <span class="md-ellipsis">
      User interface
    </span>
  </a>
  
    <nav class="md-nav" aria-label="User interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unset-trust" class="md-nav__link">
    <span class="md-ellipsis">
      Unset trust
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ignored" class="md-nav__link">
    <span class="md-ellipsis">
      Ignored
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trusted" class="md-nav__link">
    <span class="md-ellipsis">
      Trusted
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notify" class="md-nav__link">
    <span class="md-ellipsis">
      Notify
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#review" class="md-nav__link">
    <span class="md-ellipsis">
      Review
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Review">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-is-working-on-config-file" class="md-nav__link">
    <span class="md-ellipsis">
      User is working on config file.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disabling-config-messes-with-the-repo" class="md-nav__link">
    <span class="md-ellipsis">
      Disabling config messes with the repo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-effort-messes-with-the-user" class="md-nav__link">
    <span class="md-ellipsis">
      Best-effort messes with the user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manually-changing" class="md-nav__link">
    <span class="md-ellipsis">
      Manually changing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-to-read-from" class="md-nav__link">
    <span class="md-ellipsis">
      Where to read from
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Where to read from">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#problematic-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Problematic examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Problematic examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solution-1-formatter-config" class="md-nav__link">
    <span class="md-ellipsis">
      Solution 1: formatter config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solution-2-more-general-but-convoluted-wrapper-script" class="md-nav__link">
    <span class="md-ellipsis">
      Solution 2 (more general but convoluted): Wrapper script
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solution-3-for-scripts-that-need-to-run-at-trunk" class="md-nav__link">
    <span class="md-ellipsis">
      Solution 3 (for scripts that need to run at trunk)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decision-trunk-vs" class="md-nav__link">
    <span class="md-ellipsis">
      Decision: Trunk vs @
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-from-filesystem-or-from-repo-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Read from filesystem or from repo objects?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../jj-converge-command/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    JJ converge (aka resolve-divergence)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development roadmap
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#objective" class="md-nav__link">
    <span class="md-ellipsis">
      Objective
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detailed-design" class="md-nav__link">
    <span class="md-ellipsis">
      Detailed Design
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Detailed Design">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#security" class="md-nav__link">
    <span class="md-ellipsis">
      Security
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#trust-levels" class="md-nav__link">
    <span class="md-ellipsis">
      Trust levels
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#user-interface" class="md-nav__link">
    <span class="md-ellipsis">
      User interface
    </span>
  </a>
  
    <nav class="md-nav" aria-label="User interface">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unset-trust" class="md-nav__link">
    <span class="md-ellipsis">
      Unset trust
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ignored" class="md-nav__link">
    <span class="md-ellipsis">
      Ignored
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trusted" class="md-nav__link">
    <span class="md-ellipsis">
      Trusted
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#notify" class="md-nav__link">
    <span class="md-ellipsis">
      Notify
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#review" class="md-nav__link">
    <span class="md-ellipsis">
      Review
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Review">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#user-is-working-on-config-file" class="md-nav__link">
    <span class="md-ellipsis">
      User is working on config file.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disabling-config-messes-with-the-repo" class="md-nav__link">
    <span class="md-ellipsis">
      Disabling config messes with the repo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-effort-messes-with-the-user" class="md-nav__link">
    <span class="md-ellipsis">
      Best-effort messes with the user
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#manually-changing" class="md-nav__link">
    <span class="md-ellipsis">
      Manually changing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#where-to-read-from" class="md-nav__link">
    <span class="md-ellipsis">
      Where to read from
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Where to read from">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#problematic-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Problematic examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Problematic examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#solution-1-formatter-config" class="md-nav__link">
    <span class="md-ellipsis">
      Solution 1: formatter config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solution-2-more-general-but-convoluted-wrapper-script" class="md-nav__link">
    <span class="md-ellipsis">
      Solution 2 (more general but convoluted): Wrapper script
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#solution-3-for-scripts-that-need-to-run-at-trunk" class="md-nav__link">
    <span class="md-ellipsis">
      Solution 3 (for scripts that need to run at trunk)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decision-trunk-vs" class="md-nav__link">
    <span class="md-ellipsis">
      Decision: Trunk vs @
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#read-from-filesystem-or-from-repo-objects" class="md-nav__link">
    <span class="md-ellipsis">
      Read from filesystem or from repo objects?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/jj-vcs/jj/edit/main/docs/design/managed-config.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  


<h1 id="repo-managed-jj-configuration">Repo-managed JJ configuration<a class="headerlink" href="#repo-managed-jj-configuration" title="Permanent link">&para;</a></h1>
<p>Author: <a href="mailto:msta@google.com">Matt Stark</a></p>
<p>Status: Pending implementation</p>
<h2 id="background">Background<a class="headerlink" href="#background" title="Permanent link">&para;</a></h2>
<p>The design doc <a href="../secure-config/">Secure JJ Config</a> introduces a mechanism,
<code>metadata.binpb</code>, through which information about a repository / workspace can
be stored. It also discusses how allowing an external user to have control over
your config is a security risk.</p>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>There is a need for a repository to impose requirements upon users. Examples of
these things include, but are not limited to:</p>
<ul>
<li>Formatter configuration (eg. <a href="https://source.chromium.org/chromium/chromium/src/+/main:tools/jj/config.toml;l=47-96;drc=080c978973f87ff2a1cfa514a13285baeaf3eedc">Chromium Formatter Config</a>)</li>
<li>Pre-upload checks (eg. <a href="https://source.chromium.org/chromium/chromium/src/+/main:tools/jj/upload.py;drc=96f39fbbb720ca391d43cbb199a85af7d3309dd3">Chromium Pre-upload Checks</a>)</li>
<li>Syncing scripts (eg. <a href="https://source.chromium.org/chromium/chromium/src/+/main:tools/jj/sync.py;drc=6ff08dcdd1fdeb1654a4d3da81d8adaeae4bbbf7">Chromium Syncing Scripts</a>)</li>
<li>Custom aliases / revsets documented by some kind of “getting started with
    <project>” document</li>
</ul>
<p>It should be fairly obvious that there is a strong benefit to doing so. However,
controlling a user’s config is sufficient to get root access to their machine,
so we require a mechanism more complex than just blindly loading the config
file.</p>
<p>This is currently achieved by projects such as chromium by instructing the user
to symlink <code>.jj/repo/config.toml</code> to a file in the repository. This has several
drawbacks:</p>
<ul>
<li>It doesn’t work out-of-the-box. I need to manually symlink it</li>
<li>It has no security guarantees. If I update the file in the repo, the user has no
    opportunity to review it.</li>
<li>This prevents a user from having their own repo configuration on top of it.</li>
</ul>
<h2 id="objective">Objective<a class="headerlink" href="#objective" title="Permanent link">&para;</a></h2>
<ul>
<li>Create a new layer of configuration between user configuration and repo
    configuration.
    *   This configuration will be stored in version control and henceforth be
        referred to as “managed” configuration.</li>
<li>Implement it in a secure manner so that an attacker cannot take control over
    the managed config.</li>
</ul>
<h2 id="detailed-design">Detailed Design<a class="headerlink" href="#detailed-design" title="Permanent link">&para;</a></h2>
<p>The managed configuration will be read from <code>$REPO/.config/jj/config.toml</code>. This
is intentionally designed to be very similar to <code>$HOME/.config/jj/config.toml</code>
for the user configuration.</p>
<p>Any data stored here will be added to the <code>metadata.binpb</code> that was created
in <a href="../secure-config/">secure config</a> (that is, we will add additional fields to
the <code>Metadata</code> struct). This will ensure that we don't suffer from the "zip file
problem".</p>
<h3 id="security">Security<a class="headerlink" href="#security" title="Permanent link">&para;</a></h3>
<h4 id="trust-levels">Trust levels<a class="headerlink" href="#trust-levels" title="Permanent link">&para;</a></h4>
<p>We will add the following fields to metadata:
<div class="highlight"><pre><span></span><code>enum TrustLevel {
    // There&#39;s no &quot;optional&quot; in protos. It just returns the zero value.
    UNSET = 0;
    // The user wishes to completely ignore the managed config file.
    IGNORED = 1;
    // In trusted mode, we directly read from the managed config file.
    // This presents a security risk, so the user is expected to only do this
    // for a repo they trust.
    TRUSTED = 2;
    // In notify mode, the user is expected to manually replicate any changes
    // they want from the managed config to the repo config.
    NOTIFY = 3;
    // In review mode, the user has to review every config individually.
    REVIEW = 4;
}

message Metadata {
    // previous fields

    // The trust level associated with this repo.
    TrustLevel trust_level = 2;

    // When trust_level is review, the following fields are used.
    set&lt;Hash&gt; approved_configs = 3;
    set&lt;Hash&gt; rejected_configs = 4;
    // This is a can of worms and thus out of scope of the MVP.
    // There&#39;s no one correct way to choose the last approved.
    // Sometimes, the user wants be the last appproved config in the workspace.
    // At other times, the user wants be the last appproved config in the repo.
    string last_approved_config = 5;
}
</code></pre></div></p>
<p>Note that although the <code>Metadata</code> struct is stored for both the repo and the
workspace, this will only be used for the repository, not the workspace.</p>
<p>This is because trust is associated with repositories, not workspaces. If I
were to add an approved config in one workspace, for example, there is no
reason I wouldn't trust it in another.</p>
<h4 id="user-interface">User interface<a class="headerlink" href="#user-interface" title="Permanent link">&para;</a></h4>
<p>Everything here only becomes relevant when a repo has a managed config. If it
does not have a managed config, we skip everything here.</p>
<h5 id="unset-trust">Unset trust<a class="headerlink" href="#unset-trust" title="Permanent link">&para;</a></h5>
<p>If a repository has a managed config and unset trust, we first use
<code>ui.can_prompt()</code> to determine whether we are in a TUI.</p>
<ul>
<li>If we are in a TUI, we ask the user what trust level they would like.</li>
<li>If we are not in a TUI, we warn them that we are ignoring the repo config (we
    return <code>IGNORE</code>), and that they can run <code>jj config managed --ignore/notify/trust</code> in a terminal to configure this.</li>
</ul>
<h5 id="ignored">Ignored<a class="headerlink" href="#ignored" title="Permanent link">&para;</a></h5>
<p>Nice and easy. We just completely ignore the managed config file.</p>
<h5 id="trusted">Trusted<a class="headerlink" href="#trusted" title="Permanent link">&para;</a></h5>
<p>Nice and easy. We just read the managed config file.</p>
<h5 id="notify">Notify<a class="headerlink" href="#notify" title="Permanent link">&para;</a></h5>
<p>Roughly speaking, if <code>mtime(repo_config_file) &gt; mtime(managed_config)</code>, then
the config is up to date.</p>
<p>If it isn't up to date, we print a warning. The user is then expected to update
their repo config with any options they want from the managed config, which
will stop the warning from printing as the mtime has changed.</p>
<p>This notify option has a rather painful UX when it comes to keeping it in sync
(particularly for a user who constantly switches between different branches
synced to different versions), but I choose it for several reasons. The first is
that the vast majority of users will simply select to blindly trust the repo.
The only people who will choose this option are the very security conscious, and
this is by far the most secure mechanism. Secondly, it is so much simpler than
an approval based mechanism, as we don’t need to worry about things such as
workspaces being synced to different places. It provides far fewer edge cases.</p>
<p>In the future we may consider improving on the UX, doing things such as printing
a diff since the last seen config (per <code>last_approved_config</code>), but that isn't
a part of the MVP.</p>
<h5 id="review">Review<a class="headerlink" href="#review" title="Permanent link">&para;</a></h5>
<p>This is, by far, the most difficult option. There is no doubt that this
provides value to some users, but the precise details of how this should behave
is unclear (and much harder to implement than the other options).</p>
<p>The biggest problem with this is that there is not a clear "correct" set of
semantics. If a config is not approved / rejected, we have 3 options:</p>
<ul>
<li>Fail the command. This seems like a bad idea since users have an assumption
  that most jj commands will not fail.</li>
<li>Use no config. This can potentially have quite bad effects on the repo.</li>
<li>Use best-effort to use an approved config (probably most recently approved).</li>
<li>Force the user to make a selection before running a command<ul>
<li>This is impossible in general due to <code>ui.can_prompt()</code> returning false<ul>
<li>We would need to fall back to another option if we can't prompt.</li>
</ul>
</li>
<li>But <code>ui.can_prompt()</code> does not mean that we <em>should</em> prompt<ul>
<li>Eg. A script that runs jj to do a bisection probably doesn't want
  you to prompt every time the config changes.</li>
<li>This probably isn't too bad if it only happens once (eg. setting trust
  level), but if it happens many times, it could be very annoying.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Consider the following examples</p>
<h6 id="user-is-working-on-config-file">User is working on config file.<a class="headerlink" href="#user-is-working-on-config-file" title="Permanent link">&para;</a></h6>
<p>1) User runs <code>vim .config/jj/config.toml</code>
2) User tries to test out the config, but needs to manually approve their own
   local change to the config every single time (this can at least be
   mitigated via setting it to trust temporarily)</p>
<h6 id="disabling-config-messes-with-the-repo">Disabling config messes with the repo<a class="headerlink" href="#disabling-config-messes-with-the-repo" title="Permanent link">&para;</a></h6>
<p>1) User approves a config.
2) User runs <code>jj git fetch</code>. There has been an update to the managed config.
3) User runs <code>jj rebase -b @ -d trunk()</code>. The managed config is now not
   approved, and thus the next jj command will have the config disabled.</p>
<p>Depending on what has changed, a variety of things could happen:</p>
<ul>
<li>A user in a repo that defines <code>trunk()</code> could run
  <code>jj rebase -b &lt;revset&gt; -d trunk()</code><ul>
<li>This would result in it going to the wrong trunk</li>
</ul>
</li>
<li>A user in a repo that defines <code>immutable_heads() = ...</code> could run something
  like <code>jj rebase -b mutable() -d trunk()</code><ul>
<li>This would rebase a bunch of immutable commits</li>
</ul>
</li>
<li>A user in a repo that defines <code>pre-upload</code> hooks (which don't yet exist,
  but are being planned) runs <code>jj gerrit upload</code> and bypasses them entirely. </li>
</ul>
<p>Thanks to the magic of <code>jj undo</code>, everything except the upload is recoverable.
What makes them a problem, however, is the fact that a user would see the
message "please approve /reject the config" and not suspect that the command
has failed.</p>
<h6 id="best-effort-messes-with-the-user">Best-effort messes with the user<a class="headerlink" href="#best-effort-messes-with-the-user" title="Permanent link">&para;</a></h6>
<p>If we use best-effort instead, we are likely to run into a different set of
issues.</p>
<p>The first is that it's no longer clear which config is being used. If I:
1) Have two workspaces A and B with the same state, both approved.
2) Sync workspace B and approve the config
3) Check out an old version of workspace A</p>
<p>Now which config is used?</p>
<ul>
<li>The most recently approved globally?</li>
<li>The most recently approved for this workspace?</li>
<li>Some algorithm which determines that the config for A was at a closer commit
  than B?</li>
</ul>
<p>The second issue is that things may be incorrect. If <code>foo.py</code> was renamed to
<code>bar.py</code> and the reference was changed in <code>config.toml</code>, for example, the
config is going to break. This is not as large an issue as disabling config,
IMO, as changes will usually result in an obvious error.</p>
<h6 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h6>
<p>The vast majority of users will not use this option, as very few users are
security-conscious, working on a repo they don't trust, and working on a repo
with managed config.</p>
<p>Due to:</p>
<ul>
<li>Significant implementation complexity<ul>
<li>My prototype without this feature is only ~200 lines of code and ~100 lines
  of tests. This feature would likely double that for the most hacky simple
  implementation, and add significantly more if we wanted a proper nice UX.</li>
</ul>
</li>
<li>The lack of a single "correct" solution</li>
<li>The fact that most users just want the "trust" option</li>
<li>The fact that it is no more difficult to add other options, then add the
  review option after the fact</li>
<li>The time that would be required to get consensus on the various decisions
  that would need to be made in terms of how this would work.<ul>
<li>There was already a lot of
  <a href="https://github.com/jj-vcs/jj/pull/7761#discussion_r2476135221">discussion</a>
  on this topic, but no clear conclusion was reached.</li>
<li>Technical (eg. disable vs best-effort)</li>
<li>UX<ul>
<li>When reviewing, do we review diffs or full config files?</li>
<li>Do we prompt the user to review before running the command?</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>I propose that the "review" option not be put in the MVP, and and instead be
added in later.</p>
<h5 id="manually-changing">Manually changing<a class="headerlink" href="#manually-changing" title="Permanent link">&para;</a></h5>
<p>These options will also be able to be manually set via <code>jj config managed
--ignore/notify/trust</code>.</p>
<h3 id="where-to-read-from">Where to read from<a class="headerlink" href="#where-to-read-from" title="Permanent link">&para;</a></h3>
<p>This is the trickiest part of the proposal. Consider the following workflow:</p>
<div class="highlight"><pre><span></span><code>jj new main@origin
jj ...
jj new stable-branch@origin
</code></pre></div>
<p>There are some edge cases we need to consider:</p>
<ul>
<li><code>stable-branch</code> may have existed before the config was added</li>
<li><code>stable-branch</code> may have a different copy of the managed config</li>
</ul>
<p>The naive assumption would be that you want to read the config from <code>@</code>, as the
config will always match the version of the code you're using. However, it turns
out that some things want to refer to <code>@</code>, while others want to read the config
from <code>trunk()</code>.</p>
<p>Consider several different use cases:</p>
<ul>
<li>My formatter was previously <code>clang-format --foo</code>, but the option <code>--foo</code> was
    deprecated in the latest version of <code>clang-format</code>
    *   Here, you want to read from <code>trunk()</code></li>
<li>My formatter was previously <code>$repo/formatter --foo</code>, but the option <code>--foo</code>
    was deprecated in the latest version of <code>formatter</code>
    *   Here, you want to read from <code>@</code></li>
<li>We decide to split long lines and add a new formatter (or pre-upload hook)
    config <code>formatter --line-length=80</code>
    *   Here, you probably want to read from <code>@</code></li>
<li>We decide to add a pre-upload check that validates that all commit
    descriptions contain a reference to a bug
    *   This should be applied to old branches as well, so you want <code>trunk()</code></li>
<li>We add a new helpful alias / revset
    *   This should be applied to old branches as well, so you want <code>trunk()</code></li>
<li>We move our formatter
    *   If it’s external, you want to read from <code>trunk()</code>
    *   If it’s internal, you want to read from <code>@</code></li>
</ul>
<p>All in all, you can see a general pattern.</p>
<ul>
<li>If something refers to an in-repo tool, you <strong>probably</strong> want the config to
    be read from <code>@</code></li>
<li>Otherwise, you <strong>probably</strong> want to read from <code>trunk()</code></li>
<li>I say probably, because the split long lines example doesn’t conform to this
    rule.</li>
</ul>
<h4 id="problematic-examples">Problematic examples<a class="headerlink" href="#problematic-examples" title="Permanent link">&para;</a></h4>
<p>This is problematic with <code>trunk()</code> because if you add the <code>--reorder-hooks</code> and
then checkout <code>stable-branch</code> it will incorrectly attempt to reorder imports</p>
<div class="highlight"><pre><span></span><code>[fix.tools.rustfmt]
command = [&quot;rustfmt&quot;, &quot;--reorder-imports&quot;]
</code></pre></div>
<h5 id="solution-1-formatter-config">Solution 1: formatter config<a class="headerlink" href="#solution-1-formatter-config" title="Permanent link">&para;</a></h5>
<p>In practice, it is highly unlikely that a formatter config would be written that
way. Far more likely, you would see an entry in <code>config.toml</code> like:</p>
<div class="highlight"><pre><span></span><code>[fix.tools.rustfmt]
command = [&quot;rustfmt&quot;]
</code></pre></div>
<p><code>.rustfmt.toml</code>:
<div class="highlight"><pre><span></span><code>reorder_imports = true
</code></pre></div></p>
<p>This simply works out of the box, since the formatter is reading the config from
<code>@</code>'s <code>.rustfmt.toml</code></p>
<h5 id="solution-2-more-general-but-convoluted-wrapper-script">Solution 2 (more general but convoluted): Wrapper script<a class="headerlink" href="#solution-2-more-general-but-convoluted-wrapper-script" title="Permanent link">&para;</a></h5>
<p>As long as the formatter is in-repo, we can just write a wrapper script which
does this for us.</p>
<div class="highlight"><pre><span></span><code>[fix.tools.rustfmt]
command = [&quot;rustfmt.py&quot;]
</code></pre></div>
<p><code>rustfmt.py</code>:
<div class="highlight"><pre><span></span><code>os.execv([&quot;rustfmt&quot;, &quot;--reorder-imports&quot;])
</code></pre></div></p>
<h4 id="solution-3-for-scripts-that-need-to-run-at-trunk">Solution 3 (for scripts that need to run at trunk)<a class="headerlink" href="#solution-3-for-scripts-that-need-to-run-at-trunk" title="Permanent link">&para;</a></h4>
<p>If you write a script for which the API keeps changing, eg. you add / remove
flags to it, you can do something like this:</p>
<div class="highlight"><pre><span></span><code>[aliases]
upload = [&quot;util&quot;, &quot;exec&quot;, &quot;--&quot;, &quot;bash&quot;, &quot;-c&quot;, &quot;python3&quot;, &quot;-c&quot;, &quot;$(jj file show -r &#39;trunk()&#39; upload.py)&quot;]
</code></pre></div>
<h4 id="decision-trunk-vs">Decision: Trunk vs @<a class="headerlink" href="#decision-trunk-vs" title="Permanent link">&para;</a></h4>
<p><code>@</code> and <code>trunk()</code> are the only two reasonable candidates as places to read from,
IMO. I personally believe that if only one option is available, <code>trunk()</code> would
be much more appropriate, for the reasons specified above.</p>
<p>However, @pmetzger has pointed out that in a future world where Git isn’t the
backend, this decision may come back to bite us (as build tools may be checked
in to the build).</p>
<p>For now, we will only support reading from the working copy (<code>@</code>), but in the
future, we may consider supporting other revisions.</p>
<p>To achieve this, there are several methods. I'll list some of them, but they
don't need review, as they are out of scope of this proposal.</p>
<p>The simplest that comes to mind is a <code>--managed-config-from-revision</code> flag or
config option.</p>
<p>Alternatively, a more general approach could be to create some kind of include
directive in <code>config.toml</code> files, like so (this has already been discussed and
rejected before, so it may not be viable).
<div class="highlight"><pre><span></span><code>includes = [
    {
        path = &quot;other_config.toml&quot;,
        revision = &quot;trunk()&quot;,
    },
]
</code></pre></div></p>
<h4 id="read-from-filesystem-or-from-repo-objects">Read from filesystem or from repo objects?<a class="headerlink" href="#read-from-filesystem-or-from-repo-objects" title="Permanent link">&para;</a></h4>
<p>The tradeoffs are:</p>
<ul>
<li>If we read it from the filesystem, then it will not be read if the path is
  not tracked, e.g. because you have done <code>jj sparse --clear --add lib</code> or
  because the file matches .gitignore and is not yet tracked.<ul>
<li>This could be mitigated by always including <code>.config/jj</code> in <code>jj sparse</code></li>
</ul>
</li>
<li>If we read it from the repo objects, then changes will not apply to the next
  command unless we load this config after snapshotting</li>
<li>Reading from the filesystem is faster</li>
<li>mtime is only available when reading from the filesystem</li>
</ul>
<p>Reading from the filesystem seems strictly superior, given the mitigation
strategy available, so we will go ahead with that for now. If we ever decide to
support reading from <code>trunk()</code>, however, we will need to support reading from
the repo.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.code.copy", "content.tabs.link", "navigation.instant"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"alias": true, "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>